<?xml version="1.0" encoding="UTF-8"?>
<Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="file:///D:/maven/SimpleCmp/src/schemes/Configuration.xsd">
        <RaConfiguration> <!--ECC-->
                <Upstream>
                        <CmpCredentials>
                                <in enforceProtection="false">
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="true" EnablePreferCRLs="true">
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePassword="12345" KeyStorePath="certs/ppki_playground_cmp_signer.p12"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpClient ServerUrl="https://ppki-playground.ct.siemens.com:443/ejbca/publicweb/cmp/PlaygroundECC">
                                <TlsConfig KeyStorePath="certs/ppki_playground_tls.p12" KeyStorePassword="12345" EnableCrlCheck="true" EnableCRLDistPoints="true" TrustStorePath="certs/cmptrust.pem" TrustStorePassword="12345"/>
                        </CmpHttpClient>
                </Upstream>
                <Downstream AcceptRaVerified="false">
                        <EnrollmentCredentials TrustStorePath="certs/cmptrust.pem"/>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <PasswordBased Password="SecretCmp"/>
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false" EnablePreferCRLs="true">
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePath="certs/ppki_playground_cmp_signer.p12" KeyStorePassword="12345"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpServer ServingUrl="http://0.0.0.0:9080/cmp/PlaygroundECC">
                        </CmpHttpServer>
                </Downstream>
        </RaConfiguration>
        <RaConfiguration> <!--update+revoke-->
                <Upstream>
                        <CmpCredentials>
                                <in enforceProtection="false">
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="true" EnablePreferCRLs="true">
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePassword="12345" KeyStorePath="certs/ppki_playground_cmp_signer.p12"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpClient ServerUrl="https://ppki-playground.ct.siemens.com:443/ejbca/publicweb/cmp/PlaygroundCMPSigning">
                                <TlsConfig KeyStorePath="certs/ppki_playground_tls.p12" KeyStorePassword="12345" EnableCrlCheck="true" EnableCRLDistPoints="true" TrustStorePath="certs/cmptrust.pem" TrustStorePassword="12345"/>
                        </CmpHttpClient>
                </Upstream>
                <Downstream AcceptRaVerified="false">
                        <EnrollmentCredentials TrustStorePath="certs/cmptrust.pem"/>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <PasswordBased Password="SecretCmp"/>
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false" EnablePreferCRLs="true">
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                                <CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePath="certs/ppki_playground_cmp_signer.p12" KeyStorePassword="12345"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpServer ServingUrl="http://0.0.0.0:9083/cmp/PlaygroundSelf">
                        </CmpHttpServer>
                </Downstream>
        </RaConfiguration>
        <RaConfiguration> <!--ECC using signer cert disallowing key usage digitalSignature-->
                <Upstream>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false">
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePassword="12345" KeyStorePath="certs/ppki_playground_cmp_signer.p12"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpClient ServerUrl="https://ppki-playground.ct.siemens.com:443/ejbca/publicweb/cmp/PlaygroundECC">
                                <TlsConfig KeyStorePath="certs/ppki_playground_tls.p12" KeyStorePassword="12345" EnableCrlCheck="true" EnableCRLDistPoints="true" TrustStorePath="certs/cmptrust.pem" TrustStorePassword="12345"/>
                        </CmpHttpClient>
                </Upstream>
                <Downstream AcceptRaVerified="false">
                        <EnrollmentCredentials TrustStorePath="certs/cmptrust.pem"/>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <PasswordBased Password="SecretCmp"/>
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false">
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePath="certs/ppki_playground_cmp_signerWrong_keyusage.p12" KeyStorePassword="12345"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpServer ServingUrl="http://0.0.0.0:9081/cmp/PlaygroundECCWrong_keyusage">
                        </CmpHttpServer>
                </Downstream>
        </RaConfiguration>
        <RaConfiguration> <!--ECC using expired server cert-->
                <Upstream>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false">
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePassword="12345" KeyStorePath="certs/ppki_playground_cmp_signer.p12"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpClient ServerUrl="https://ppki-playground.ct.siemens.com:443/ejbca/publicweb/cmp/PlaygroundECC">
                                <TlsConfig KeyStorePath="certs/ppki_playground_tls.p12" KeyStorePassword="12345" EnableCrlCheck="true" EnableCRLDistPoints="true" TrustStorePath="certs/cmptrust.pem" TrustStorePassword="12345"/>
                        </CmpHttpClient>
                </Upstream>
                <Downstream AcceptRaVerified="false">
                        <EnrollmentCredentials TrustStorePath="certs/cmptrust.pem"/>
                        <CmpCredentials>
                                <in enforceProtection="true">
                                        <PasswordBased Password="SecretCmp"/>
                                        <SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false">
                                        </SignatureBased>
                                </in>
                                <out reprotectMode="reprotect">
                                        <SignatureBased KeyStorePath="certs/ppki_playground_cmp_expired_srvcert.p12" KeyStorePassword="12345"/>
                                </out>
                        </CmpCredentials>
                        <CmpHttpServer ServingUrl="http://0.0.0.0:9082/cmp/PlaygroundECC_expired_srvcert">
                        </CmpHttpServer>
                </Downstream>
        </RaConfiguration>
	<RaConfiguration> <!--ECC TLS-->
		<Upstream>
			<CmpCredentials>
				<in enforceProtection="true">
					<SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="true" EnablePreferCRLs="true">
						<CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
						<CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
					</SignatureBased>
				</in>
				<out reprotectMode="reprotect">
					<SignatureBased KeyStorePassword="12345" KeyStorePath="certs/ppki_playground_cmp_signer.p12"/>
				</out>
			</CmpCredentials>
			<CmpHttpClient ServerUrl="https://ppki-playground.ct.siemens.com:443//ejbca/publicweb/cmp/PlaygroundECC">
				<TlsConfig KeyStorePath="certs/ppki_playground_tls.p12" KeyStorePassword="12345" EnableCrlCheck="true" EnableCRLDistPoints="true" TrustStorePath="certs/cmptrust.pem" TrustStorePassword="12345"/>
			</CmpHttpClient>
		</Upstream>
		<Downstream AcceptRaVerified="false">
			<EnrollmentCredentials TrustStorePath="certs/cmptrust.pem"/>
			<CmpCredentials>
				<in enforceProtection="true">
					<PasswordBased Password="SecretCmp"/>
					<SignatureBased TrustStorePath="certs/cmptrust.pem" EnableCrlCheck="false" EnablePreferCRLs="true">
						<CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Issuing+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
						<CrlUrl uri="http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&amp;issuer=CN%3dPPKI+Playground+ECC+Root+CA+v1.0%2cOU%3dCorporate+Technology%2cOU%3dFor+internal+test+purposes+only%2cO%3dSiemens%2cC%3dDE"/>
					</SignatureBased>
				</in>
				<out reprotectMode="reprotect">
					<SignatureBased KeyStorePath="certs/ppki_playground_cmp_signer.p12" KeyStorePassword="12345"/>
				</out>
			</CmpCredentials>
			<CmpHttpServer ServingUrl="https://0.0.0.0:9085/cmp/PlaygroundECC">
				<TlsConfig KeyStorePath="certs/localhost.p12" KeyStorePassword="12345" TrustStorePath="certs/cmptrust.pem" ClientAuthenticationNeeded="true" EnableCrlCheck="false" EnableCRLDistPoints="true"/>
			</CmpHttpServer>
		</Downstream>
	</RaConfiguration>
</Configuration>
